import{r,j as t,a as G,u as I}from"./index-FvIQGKJN.js";import{v as C,d as F}from"./debounce-C1zwnBCj.js";const O=({letterPosition:s=0,attemptValue:a=0})=>{const[c,d]=r.useState(!1),{board:o,correctWord:x,currentAttempt:l,setDisabledLetters:p,setCorrectLetters:n,setAlmostLetters:f}=r.useContext(j),e=o[a][s];let u=x[s]==e,i=!u&&e!=""&&x.includes(e);const L=l.attempt>a&&(u?"correct":i?"almost":"error");return r.useEffect(()=>{e!=""&&u&&n(E=>[...E,e]),e!=""&&i&&f(E=>[...E,e]),e!=""&&!u&&!i&&p(E=>[...E,e])},[l.attempt]),r.useEffect(()=>{if(e!=""){d(!0);const E=setTimeout(()=>{d(!1)},200);return()=>clearTimeout(E)}},[e]),t.jsx("div",{className:`letter ${c?"scale":""}`,id:L||null,children:e})},$=()=>{const{board:s}=r.useContext(j);return t.jsx("div",{className:"board",children:s.map((a,c)=>t.jsx("div",{className:"row",children:a.map((d,o)=>t.jsx(O,{letterPosition:o,attemptValue:c},o))},c))})},w=({keyValue:s,bigKey:a,correct:c,almost:d,disabled:o})=>{const{onSelectLetter:x,onDelete:l,onDebouncedEnter:p}=r.useContext(j),n=()=>{s=="ENTER"?p():s=="DELETE"?l():x(s)};return t.jsx("div",{className:`key ${c?"key-correct":d?"key-almost":o?"key-disabled":""}`,id:`${a?"big":""}`,onClick:n,children:s})},Y=()=>{const s=["Q","W","E","R","T","Y","U","I","O","P"],a=["A","S","D","F","G","H","J","K","L"],c=["Z","X","C","V","B","N","M"],{onDebouncedEnter:d,onDelete:o,onSelectLetter:x,correctLetters:l,almostLetters:p,disabledLetters:n}=r.useContext(j),f=e=>{const u=e.key;u=="Enter"?d():u=="Backspace"?o():(s.forEach(i=>{u.toUpperCase()==i&&x(i)}),a.forEach(i=>{u.toUpperCase()==i&&x(i)}),c.forEach(i=>{u.toUpperCase()==i&&x(i)}))};return r.useEffect(()=>(document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}),[f]),t.jsxs("div",{className:"keyboard",onKeyDown:f,children:[t.jsx("div",{className:"line1",children:s.map(e=>t.jsx(w,{keyValue:e,correct:l.includes(e),almost:p.includes(e),disabled:n.includes(e)},e))}),t.jsx("div",{className:"line2",children:a.map(e=>t.jsx(w,{keyValue:e,correct:l.includes(e),almost:p.includes(e),disabled:n.includes(e)},e))}),t.jsxs("div",{className:"line3",children:[t.jsx(w,{keyValue:"ENTER",bigKey:!0}),c.map(e=>t.jsx(w,{keyValue:e,correct:l.includes(e),almost:p.includes(e),disabled:n.includes(e)},e)),t.jsx(w,{keyValue:"DELETE",bigKey:!0})]})]})},Z=({text:s})=>t.jsx("div",{className:"toast",children:s}),D=({win:s})=>{const{correctWord:a}=r.useContext(j);return t.jsxs("div",{className:"modal",children:[t.jsx("p",{className:"modal-text",children:s?"You won the game! ðŸŽ‰":"You lost the game!"}),s?null:t.jsxs("p",{children:["Correct Word: ",a]})]})},j=r.createContext(),y=(s,a)=>{document.documentElement.style.setProperty(s,a)},k=()=>{const{id:s}=G(),a=I(),[c,d]=r.useState([["","","","",""],["","","","",""],["","","","",""],["","","","",""],["","","","",""]]),[o,x]=r.useState(""),[l,p]=r.useState(null),[n,f]=r.useState({attempt:0,letterPosition:0}),[e,u]=r.useState([]),[i,L]=r.useState([]),[E,A]=r.useState([]),[T,N]=r.useState(!1),[P,U]=r.useState(!1),[S,V]=r.useState(!1),K=h=>{if(P||S||n.letterPosition>o.length-1)return;const b=[...c];b[n.attempt][n.letterPosition]=h,d(b),f(m=>({...m,letterPosition:m.letterPosition+1}))},B=()=>{if(n.letterPosition==0)return;const h=[...c];h[n.attempt][n.letterPosition-1]="",d(h),f(b=>({...b,letterPosition:b.letterPosition-1}))},g=async()=>{if(n.letterPosition!=o.length)return;let h="";for(let m=0;m<o.length;m++)h+=c[n.attempt][m];if(await C(h)?f(m=>({...m,attempt:m.attempt+1,letterPosition:0})):(N(!0),setTimeout(()=>{N(!1)},1500)),h==o){U(!0);return}n.attempt==l-1&&V(!0)},M=F(g,500);return r.useEffect(()=>{if(o&&l){let h=o.length,b=Array(l).fill(null).map(()=>Array(h).fill(""));d(b),y("--correct-word-length",Number(o.length)),y("--number-of-guesses",Number(l))}},[o,l]),r.useEffect(()=>{(async()=>{if(s){if(!/^[A-Za-z0-9+/=]+-\d+$/.test(s))throw new Error("Invalid URL format. Expected format: 'encodedWord-numberOfGuesses'");let m=s.split("-");const R=m[0];try{const W=window.atob(R).toUpperCase();if(await C(W))x(W);else throw a("/error"),new Error("Invalid decoded word. Word not in word bank")}catch{throw new Error("Invalid encoded word. Unable to decode.")}let v=m[1];if(v<5||v>8)throw new Error("Invalid number of guesses.");p(Number(v))}})()},[s]),t.jsx(t.Fragment,{children:t.jsx(j.Provider,{value:{board:c,setBoard:d,correctWord:o,numberOfGuesses:l,currentAttempt:n,setCurrentAttempt:f,onSelectLetter:K,onDelete:B,onEnter:g,onDebouncedEnter:M,disabledLetters:E,setDisabledLetters:A,correctLetters:e,setCorrectLetters:u,almostLetters:i,setAlmostLetters:L},children:t.jsxs("div",{className:"game",children:[t.jsx($,{}),t.jsx(Y,{}),T?t.jsx(Z,{text:"Invalid Word!"}):null,P?t.jsx(D,{win:!0}):null,S?t.jsx(D,{win:!1}):null]})})})},Q=()=>t.jsx(k,{});export{Q as default};
